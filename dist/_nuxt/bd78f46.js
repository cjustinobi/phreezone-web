(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{1092:function(e,t,n){"use strict";n.r(t);n(95);var r=n(27),c=[{title:"Full Name",dataIndex:"user.full_name"},{title:"Amount",key:"amount",dataIndex:"amount",scopedSlots:{customRender:"amount"}},{title:"Status",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"Action",dataIndex:"",scopedSlots:{customRender:"action"}}],o={name:"sales-list",layout:"dashboard",data:function(){return{sales:"",columns:c,visible:!1,confirmLoading:!1,rejectReason:"",selectedSaleId:""}},methods:{getSales:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$post("admin/sales");case 2:e.sales=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},handleSearch:function(e,t,n){t(),this.searchText=e[0],this.searchedColumn=n},handleReset:function(e){e(),this.searchText=""},confirmSale:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t,n.next=3,t.$axios.$post("admin/updateSale/".concat(e),{status:"approved"});case 3:if(!n.sent.success){n.next=7;break}return t.$message.success("Sale updated successfully"),n.abrupt("return",t.getSales());case 7:t.$message.error("Payment not confirmed");case 8:case"end":return n.stop()}}),n)})))()},rejectSale:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$post("admin/updateSale/".concat(e.selectedSaleId),{status:"rejected",reject_reason:e.rejectReason});case 2:if(!t.sent.success){t.next=7;break}return e.reset(),e.$message.success("Sales Rejected"),t.abrupt("return",e.getSales());case 7:e.$message.error("Rejection not successful"),e.reset();case 9:case"end":return t.stop()}}),t)})))()},cancelSale:function(e){this.visible=!0,this.selectedSaleId=e},reset:function(){this.rejectReason="",this.selectedSaleId="",this.visible=!1}},mounted:function(){this.getSales()}},l=n(34),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-page-header",{attrs:{"sub-title":"List of Stockist Sales"}}),e._v(" "),n("a-modal",{attrs:{title:"Reason for rejecting Sale",visible:e.visible,"confirm-loading":e.confirmLoading},on:{ok:e.rejectSale,cancel:function(t){e.visible=!1}}},[n("a-textarea",{attrs:{placeholder:"Reason for rejecting","auto-size":{minRows:2,maxRows:6}},model:{value:e.rejectReason,callback:function(t){e.rejectReason=t},expression:"rejectReason"}})],1),e._v(" "),e.sales?n("a-table",{attrs:{columns:e.columns,"data-source":e.sales,rowKey:function(e){return e.id},size:"small"},scopedSlots:e._u([{key:"action",fn:function(t){return"pending"==t.status?n("a-dropdown",{attrs:{href:"javascript:;"}},[n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",{key:"1"},[n("a-popconfirm",{attrs:{title:"Are you sure confirming this sale?","ok-text":"Yes","cancel-text":"No"},on:{confirm:function(n){return e.confirmSale(t.shopping_id)},cancel:function(t){e.visible=!1}}},[n("a",{attrs:{href:"#"}},[e._v("Confirm")])])],1),e._v(" "),n("a-menu-item",{key:"2"},[n("a-popconfirm",{attrs:{title:"You about to reject this payment?","ok-text":"Yes","cancel-text":"No"},on:{confirm:function(n){return e.cancelSale(t.shopping_id)},cancel:function(t){e.visible=!1}}},[n("a",{attrs:{href:"#"}},[e._v("Reject")])])],1)],1),e._v(" "),n("a-button",[e._v(" Actions\n          "),n("a-icon",{attrs:{type:"down"}})],1)],1):e._e()}},{key:"filterDropdown",fn:function(t){var r=t.setSelectedKeys,c=t.selectedKeys,o=t.confirm,l=t.clearFilters,d=t.column;return n("div",{staticStyle:{padding:"8px"}},[n("a-input",{directives:[{name:"ant-ref",rawName:"v-ant-ref",value:function(t){return e.searchInput=t},expression:"c => (searchInput = c)"}],staticStyle:{width:"188px","margin-bottom":"8px",display:"block"},attrs:{placeholder:"Search "+d.dataIndex,value:c[0]},on:{change:function(e){return r(e.target.value?[e.target.value]:[])},pressEnter:function(){return e.handleSearch(c,o,d.dataIndex)}}}),e._v(" "),n("a-button",{staticStyle:{width:"90px","margin-right":"8px"},attrs:{type:"primary",icon:"search",size:"small"},on:{click:function(){return e.handleSearch(c,o,d.dataIndex)}}},[e._v("\n          Search\n        ")]),e._v(" "),n("a-button",{staticStyle:{width:"90px"},attrs:{size:"small"},on:{click:function(){return e.handleReset(l)}}},[e._v("\n          Reset\n        ")])],1)}},{key:"filterIcon",fn:function(e){return n("a-icon",{style:{color:e?"#108ee9":void 0},attrs:{type:"search"}})}},{key:"fullName",fn:function(text,t,r,c){return[e.searchText&&e.searchedColumn===c.dataIndex?n("span"):e._e()]}},{key:"status",fn:function(t){return n("span",{},[n("a-tag",{attrs:{color:"pending"==t?"volcano":"rejected"==t?"red":"green"}},[e._v(e._s(t))])],1)}},{key:"amount",fn:function(t,r){return n("span",{},[n("span",[e._v(e._s(e._f("currency")(t)))])])}}],null,!0)}):e._e()],1)}),[],!1,null,null,null);t.default=component.exports}}]);