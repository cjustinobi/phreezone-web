(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1074:function(e,t,r){"use strict";r.r(t);r(187),r(586),r(98),r(906);var n=r(917),o=(r(95),r(27)),l=r(8),d=r.n(l),c=r(909),f={name:"add-promo",layout:"dashboard",components:{quillEditor:r(556).quillEditor},mixins:[c.a],data:function(){var e=this;return{loading:!1,editorOption:{},fileList:"",details:{title:"",pv:"",leg_pv:"",description:"",balanced_leg:"",personal_points:"",start_date:"",end_date:"",image_path:""},rules:{title:[{required:!0,message:"Name is required",trigger:"change"}],pv:[{required:!0,message:"Point is required",trigger:"change"}],balanced_leg:[{validator:function(e,t,r){if(""==t)return r(new Error("Leg balancing not specified"));r()},trigger:"change"}],balanced_leg_value:[{validator:function(t,r,n){if("1"==e.details.balanced_leg&&""==r)return n(new Error("Downline point not specified"));n()},trigger:"change"}],personal_points:[{required:!0,message:"Type of point is required",trigger:"change"}]}}},methods:{moment:d.a,submitPromo:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.validateDate()){r.next=2;break}return r.abrupt("return",t.$message.error("End date must be greater than Start date"));case 2:t.$refs[e].validate(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=15;break}return t.loading=!0,e.next=4,t.saveFile(t.fileList[0]);case 4:return t.details.image_path=e.sent.secure_url,e.next=7,t.$axios.$post("admin/promos",t.details);case 7:if(!e.sent.success){e.next=13;break}return t.loading=!1,t.fileList="",t.details={},e.abrupt("return",t.$message.success("Successfully saved"));case 13:return t.loading=!1,e.abrupt("return",t.$message.error("Encountered error"));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return r.stop()}}),r)})))()},startDate:function(e,t){this.details.start_date=t},endDate:function(e,t){this.details.end_date=t},disabledDate:function(e){return e&&e<d()().endOf("day")},validateDate:function(){var e=Date.parse(this.details.start_date);return Date.parse(this.details.end_date)>e},handleRemove:function(e){var t=this.fileList.indexOf(e),r=this.fileList.slice();r.splice(t,1),this.fileList=r},beforeUpload:function(e){return this.fileList=[].concat(Object(n.a)(this.fileList),[e]),!1}},computed:{disableEndDate:function(){return!this.details.start_date}}},m=r(34),component=Object(m.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-row",[r("a-page-header",{attrs:{"sub-title":"Add Promos"}},[r("template",{slot:"extra"},[r("a-button",{attrs:{type:"primary"},on:{click:function(){return e.$router.push("/promos")}}},[e._v("All Promos")])],1)],2),e._v(" "),r("a-col",{attrs:{md:12}},[r("a-form-model",{ref:"promoForm",attrs:{model:e.details,rules:e.rules,hideRequiredMark:!0}},[r("a-form-model-item",{attrs:{prop:"title"}},[r("a-input",{staticStyle:{"margin-top":"5px"},attrs:{size:"large",placeholder:"Promo Title"},model:{value:e.details.title,callback:function(t){e.$set(e.details,"title",t)},expression:"details.title"}})],1),e._v(" "),r("a-form-model-item",{attrs:{prop:"point"}},[r("a-input",{staticStyle:{"margin-top":"5px"},attrs:{size:"large",placeholder:"Promo Point"},model:{value:e.details.pv,callback:function(t){e.$set(e.details,"pv",t)},expression:"details.pv"}})],1),e._v(" "),r("quill-editor",{staticClass:"quill",attrs:{options:e.editorOption},model:{value:e.details.description,callback:function(t){e.$set(e.details,"description",t)},expression:"details.description"}}),r("br"),e._v(" "),r("a-form-model-item",[r("a-upload",{attrs:{"list-type":"picture","default-file-list":e.fileList,remove:e.handleRemove,"before-upload":e.beforeUpload}},[r("a-button",[r("a-icon",{attrs:{type:"upload"}}),e._v("\n            Upload Promo Image\n          ")],1)],1)],1),e._v(" "),r("a-form-model-item",{attrs:{prop:"personal_points"}},[r("a-radio-group",{model:{value:e.details.personal_points,callback:function(t){e.$set(e.details,"personal_points",t)},expression:"details.personal_points"}},[r("label",[e._v("For Personal Point?")]),r("br"),e._v(" "),r("a-radio",{attrs:{value:"1"}},[e._v("\n            Yes\n          ")]),e._v(" "),r("a-radio",{staticStyle:{"margin-left":"80px"},attrs:{value:"0"}},[e._v("\n            No\n          ")])],1)],1),e._v(" "),"0"==e.details.personal_points?r("a-form-model-item",{attrs:{prop:"balanced_leg"}},[r("a-radio-group",{model:{value:e.details.balanced_leg,callback:function(t){e.$set(e.details,"balanced_leg",t)},expression:"details.balanced_leg"}},[r("label",[e._v("Both legs must be balanced?")]),r("br"),e._v(" "),r("a-radio",{attrs:{value:"1"}},[e._v("\n            Yes\n          ")]),e._v(" "),r("a-radio",{staticStyle:{"margin-left":"80px"},attrs:{value:"0"}},[e._v("\n            No\n          ")])],1)],1):e._e(),e._v(" "),"1"==e.details.balanced_leg?r("a-form-model-item",{attrs:{prop:"balanced_leg_value"}},[r("a-input",{staticStyle:{"margin-top":"5px"},attrs:{size:"large",placeholder:"Enter point for each leg "},model:{value:e.details.leg_pv,callback:function(t){e.$set(e.details,"leg_pv",t)},expression:"details.leg_pv"}})],1):e._e(),e._v(" "),r("a-row",{attrs:{type:"flex",justify:"space-around"}},[r("a-col",[r("a-form-model",[r("label",[e._v("Start Date")]),e._v(" "),r("a-date-picker",{staticClass:"form-control",attrs:{"disabled-date":e.disabledDate},on:{change:e.startDate}})],1)],1),e._v(" "),r("a-col",[r("a-form-model",[r("label",[e._v("End Date")]),e._v(" "),r("a-date-picker",{staticClass:"form-control",attrs:{"disabled-date":e.disabledDate,disabled:e.disableEndDate},on:{change:e.endDate}})],1)],1)],1),e._v(" "),r("a-form-model-item",[r("a-button",{staticClass:"btn-auth app-btn",attrs:{loading:e.loading,type:"primary"},on:{click:function(t){return e.submitPromo("promoForm")}}},[e._v("\n          Submit\n        ")])],1)],1)],1)],1)}),[],!1,null,"009023b2",null);t.default=component.exports},906:function(e,t,r){"use strict";var n=r(28),o=r(306),l=r(165),d=r(62),c=r(97),f=r(307),m=r(184),v=r(185),_=r(96),h=v("splice"),x=_("splice",{ACCESSORS:!0,0:0,1:2}),y=Math.max,w=Math.min;n({target:"Array",proto:!0,forced:!h||!x},{splice:function(e,t){var r,n,v,_,h,x,k=c(this),D=d(k.length),S=o(e,D),$=arguments.length;if(0===$?r=n=0:1===$?(r=0,n=D-S):(r=$-2,n=w(y(l(t),0),D-S)),D+r-n>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(v=f(k,n),_=0;_<n;_++)(h=S+_)in k&&m(v,_,k[h]);if(v.length=n,r<n){for(_=S;_<D-n;_++)x=_+r,(h=_+n)in k?k[x]=k[h]:delete k[x];for(_=D;_>D-n+r;_--)delete k[_-1]}else if(r>n)for(_=D-n;_>S;_--)x=_+r-1,(h=_+n-1)in k?k[x]=k[h]:delete k[x];for(_=0;_<r;_++)k[_+S]=arguments[_+2];return k.length=D-n+r,v}})},909:function(e,t,r){"use strict";r(48),r(95);var n=r(27);t.a={methods:{saveFile:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,data;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e){r.next=3;break}return r.abrupt("return",console.log("No file"));case 3:return o=function(e){return new Promise((function(t){var r=new FileReader;r.onloadend=function(){return t(r.result)},r.readAsDataURL(e)}))},r.next=6,o(n);case 6:return data=r.sent,r.abrupt("return",t.$cloudinary.upload(data,{folder:"phreezone",upload_preset:"foodie_preset"}));case 8:case"end":return r.stop()}}),r)})))()}}}},917:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(266);var o=r(312);function l(e){return function(e){if(Array.isArray(e))return Object(n.a)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);