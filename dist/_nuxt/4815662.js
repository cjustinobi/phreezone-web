(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1012:function(e,t,r){"use strict";r(932)},1013:function(e,t,r){(t=r(45)(!1)).push([e.i,"table{font-family:arial,sans-serif;border-collapse:collapse;width:100%}td,th{border:1px solid #ddd;text-align:left;padding:8px}tr:nth-child(2n){background-color:#ddd}#sub,#subpv{font-weight:900}",""]),e.exports=t},1086:function(e,t,r){"use strict";r.r(t);r(52),r(903),r(95);var n=r(27),o=r(44),c=r.n(o),d=[{title:"Code",dataIndex:"code"},{title:"Name",dataIndex:"name"},{title:"Price",dataIndex:"amount"},{title:"PV",dataIndex:"pv"},{title:"Quantity",scopedSlots:{customRender:"qty"}},{title:"Subtotal",scopedSlots:{customRender:"sub"}}],l={name:"phreezone-special",layout:"dashboard",middleware:["stockist"],data:function(){return{loading:!1,columns:d,agentWallet:"",categories:"",products:[],tabProducts:[],selectedProducts:[],userReferral:"",upgradeUser:"",percentageRate:""}},methods:{submitOrder:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(document.getElementById("sub").innerText>e.agentWallet)){t.next=3;break}return t.abrupt("return",e.$message.error("Insufficient amount in wallet"));case 3:if(e.products.length&&e.upgradeUser){t.next=5;break}return t.abrupt("return",e.$message.error("All fields are required"));case 5:return e.loading=!0,t.next=8,e.$axios.$post("user/saveOrders",{soldBy:e.userId,boughtBy:e.upgradeUser.id,items:e.products,totalAmount:document.getElementById("sub").innerText,totalPv:document.getElementById("subpv").innerText});case 8:t.sent.success&&(e.reset(),e.$message.success("Added successfully"));case 10:case"end":return t.stop()}}),t)})))()},getAgentWallet:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("admin/agentWallet/".concat(e.userId));case 2:e.agentWallet=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},getMember:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.$post("user/null",{userReferral:e.userReferral});case 3:e.upgradeUser=t.sent.data,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),e.$message.error("Invalid Referral code entered");case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},getProducts:function(){var e=arguments,t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.length>0&&void 0!==e[0]?e[0]:1,r.next=3,t.$axios.$get("admin/products?active=true");case 3:t.products=r.sent.data;case 4:case"end":return r.stop()}}),r)})))()},setTabProducts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.tabProducts=this.products.filter((function(t){return t.category_id==e})),console.log(this.tabProducts)},getPercentageRate:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("admin/percentageRate");case 2:e.percentageRate=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},populateField:function(e,t){var r=this,n=e.target.value;document.querySelectorAll("table #sub-".concat(t.id));c()((function(){var sub=0,e=0;c()("tr .sub").each((function(e,t){var r=parseFloat(c()(this).text());sub+=r})),c()("tr .subpv").each((function(t,r){var n=parseFloat(c()(this).text());e+=n})),document.getElementById("sub").innerHTML="<b>".concat(r.calcSubtotal(sub),"</b>"),document.getElementById("subpv").innerHTML="<b>".concat(e,"</b>")})),document.getElementById("sub-".concat(t.id)).innerText=n*t.amount,document.getElementById("subpv-".concat(t.id)).innerText=n*t.pv,this.addProduct(t,n)},calcSubtotal:function(sub){return sub+sub*this.percentageRate},getProductCategories:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("admin/product-category");case 2:e.categories=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},addProduct:function(e,t){if(0!=t){if(t){var r=this.selectedProducts.findIndex((function(t){return t.id==e.id}));r>-1?this.selectedProducts[r].qty=t:(e.qty=t,this.selectedProducts.push(e))}}else this.selectedProducts=this.selectedProducts.filter((function(t){return t.id!=e.id}))},reset:function(){this.agentWallet-=document.getElementById("sub").innerHTML,this.loading=!1,this.products=[],this.userReferral="",this.upgradeUser="",document.getElementById("sub").innerHTML="<b>0</b>",document.getElementById("subpv").innerHTML="<b>0</b>",c()((function(){c()("tr .sub").each((function(e,t){c()(this).text(0)})),c()("tr .subpv").each((function(e,t){c()(this).text(0)}))}))}},beforeMount:function(){this.getAgentWallet(),this.getProducts(),this.getProductCategories(),this.getPercentageRate()}},f=(r(1012),r(34)),component=Object(f.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-page-header",{attrs:{"sub-title":"Stream Upgrade Order"}}),e._v(" "),r("a-row",{attrs:{type:"flex",justify:"space-between"}},[r("a-col",{attrs:{md:{span:6},xs:{span:24}}},[e.agentWallet?r("h5",[r("span",{staticStyle:{color:"grey"}},[e._v("Available Amount: ")]),e._v(e._s(e._f("currency")(e.agentWallet)))]):r("h5",[e._v("Available Amount: NGN 0.00")]),e._v(" "),r("br"),e._v(" "),e.upgradeUser?r("h6",[e._v(e._s(e.upgradeUser.full_name))]):e._e(),e._v(" "),r("a-input",{attrs:{placeholder:"Member code"},on:{blur:e.getMember},model:{value:e.userReferral,callback:function(t){e.userReferral=t},expression:"userReferral"}}),e._v(" "),r("br"),r("br")],1),e._v(" "),r("a-col",{attrs:{md:{span:6}}},[r("a-card",{staticStyle:{width:"230px"},attrs:{size:"small",title:"Product Order"}},[r("div",[e._v("Total Order Amount: "),r("span",{attrs:{id:"sub"}},[e._v("0")])]),e._v(" "),r("div",[e._v("Total PV: "),r("span",{attrs:{id:"subpv"}},[e._v("0")])])]),e._v(" "),r("br"),e._v(" "),r("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return t.preventDefault(),e.submitOrder(t)}}},[e._v("Submit")])],1)],1),e._v(" "),r("a-tabs",{attrs:{"default-active-key":"1"},on:{change:e.setTabProducts}},e._l(e.categories,(function(t){return r("a-tab-pane",{key:t.id,attrs:{tab:t.name}},[r("div",{staticStyle:{"overflow-x":"auto"}},[r("table",{attrs:{id:"table"}},[r("tr",[r("th",[e._v("Code")]),e._v(" "),r("th",[e._v("Name")]),e._v(" "),r("th",[e._v("Price")]),e._v(" "),r("th",[e._v("PV")]),e._v(" "),r("th",[e._v("Quantity")]),e._v(" "),r("th",[e._v("Subtotal")]),e._v(" "),r("th",[e._v("Subtotal PV")])]),e._v(" "),e._l(e.tabProducts,(function(t){return r("tr",[r("td",[e._v(e._s(t.code))]),e._v(" "),r("td",[e._v(e._s(t.name))]),e._v(" "),r("td",[e._v(e._s(t.amount))]),e._v(" "),r("td",[e._v(e._s(t.pv))]),e._v(" "),r("td",[r("a-input",{staticClass:"qty",staticStyle:{width:"100px"},attrs:{min:"0",type:"number"},on:{change:function(r){return e.populateField(r,t)}}})],1),e._v(" "),r("td",{ref:"sub-"+t.id,refInFor:!0,staticClass:"sub",attrs:{id:"sub-"+t.id}},[e._v("0.00")]),e._v(" "),r("td",{ref:"subpv-"+t.id,refInFor:!0,staticClass:"subpv",attrs:{id:"subpv-"+t.id}},[e._v("0.00")])])}))],2)])])})),1)],1)}),[],!1,null,null,null);t.default=component.exports},903:function(e,t,r){"use strict";var n=r(28),o=r(138).findIndex,c=r(305),d=r(96),l=!0,f=d("findIndex");"findIndex"in[]&&Array(1).findIndex((function(){l=!1})),n({target:"Array",proto:!0,forced:l||!f},{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),c("findIndex")},932:function(e,t,r){var content=r(1013);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(46).default)("7f95a08c",content,!0,{sourceMap:!1})}}]);