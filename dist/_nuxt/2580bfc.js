(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1008:function(t,e,r){"use strict";r(930)},1009:function(t,e,r){(e=r(45)(!1)).push([t.i,".pr-tr[data-v-5cb07863]{margin-bottom:20px}",""]),t.exports=e},1084:function(t,e,r){"use strict";r.r(e);r(187),r(903),r(586),r(98),r(906),r(82);var n=r(917),o=(r(95),r(27)),c=r(909),d=[{title:"Image",dataIndex:"image_path",scopedSlots:{customRender:"image"}},{title:"Code",dataIndex:"code"},{title:"Name",dataIndex:"name"},{title:"Amount",dataIndex:"price",scopedSlots:{customRender:"price"}},{title:"Actual Amount",dataIndex:"actual_amount",scopedSlots:{customRender:"amount"}},{title:"PV",dataIndex:"pv"},{title:"Status",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"Action",scopedSlots:{customRender:"action"}}],l={name:"phreezone-products",layout:"dashboard",mixins:[c.a],data:function(){return{showTable:"none",searching:!1,loading:!1,editMode:!1,productForm:!1,defaultPageSize:2e3,searchQuery:"",productId:"",columns:d,fileList:"",item:{name:"",code:"",price:"",actual_amount:"",pv:"",category_id:""},products:"",categories:"",excelFields:{Image:"image_path",Code:"code",AccountNumber:{field:"code",callback:function(t){return JSON.stringify(t)}}}}},methods:{createProduct:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.item.name&&t.item.price&&t.item.actual_amount&&t.item.pv){e.next=2;break}return e.abrupt("return",t.$message.error("All fields are required"));case 2:return t.loading=!0,e.prev=3,e.next=6,t.saveFile(t.fileList[0]);case 6:t.item.image_path=e.sent.secure_url,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),t.$message.error(e.t0);case 12:if(!t.editMode){e.next=18;break}return e.next=15,t.$axios.$put("admin/products/".concat(t.productId),t.item);case 15:e.t1=e.sent,e.next=21;break;case 18:return e.next=20,t.$axios.$post("admin/products",t.item);case 20:e.t1=e.sent;case 21:if(!e.t1.success){e.next=27;break}return e.next=25,t.getProducts();case 25:t.$message.success("Successfully updated"),t.reset();case 27:case"end":return e.stop()}}),e,null,[[3,9]])})))()},disableEnableProduct:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$axios.$put("admin/products/disable-enable/".concat(t.id),{status:!t.status});case 2:(n=r.sent).success&&(o=e.products.findIndex((function(e){return e.id==t.id})),e.products[o].status=n.data.status,e.$message.success("Successfully updated"));case 4:case"end":return r.stop()}}),r)})))()},getProducts:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.$get("admin/products");case 2:t.products=e.sent.data;case 3:case"end":return e.stop()}}),e)})))()},getProductCategories:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.$get("admin/product-category");case 2:t.categories=e.sent.data;case 3:case"end":return e.stop()}}),e)})))()},editProduct:function(t){this.item=t,this.productId=t.id,this.productForm=!0,this.editMode=!0},deleteProduct:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$axios.$delete("admin/products/".concat(t));case 2:n=r.sent,n.success&&(e.getProducts(),e.$message.success("Successfully deleted"));case 5:case"end":return r.stop()}}),r)})))()},search:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=t.searchQuery){e.next=2;break}return e.abrupt("return");case 2:return t.searching=!0,e.next=5,t.$axios.$post("admin/product-search",{searchQuery:t.searchQuery});case 5:if(!(r=e.sent).data.length){e.next=9;break}return t.searching=!1,e.abrupt("return",t.products=r.data);case 9:t.searching=!1;case 10:case"end":return e.stop()}}),e)})))()},resetProducts:function(){this.searchQuery="",this.getProducts()},setCode:function(){var t=this.item;if(t.name.length<=2)return t.code="";!t.code&&t.name.length>=3&&(t.code=t.name.substring(0,3).toUpperCase(),t.code+=Math.floor(100+900*Math.random()))},reset:function(){this.item={},this.loading=!1,this.productForm=!1,this.editMode=!1},handleRemove:function(t){var e=this.fileList.indexOf(t),r=this.fileList.slice();r.splice(e,1),this.fileList=r},beforeUpload:function(t){return this.fileList=[].concat(Object(n.a)(this.fileList),[t]),!1},printProduct:function(){return this.showTable="block",this.$nextTick((function(){var t=this.$refs.example,e=window.open("");e.document.write(t.outerHTML),e.print(),e.close(),this.showTable="none"})),!0}},beforeMount:function(){this.getProducts(),this.getProductCategories()}},m=(r(1008),r(34)),component=Object(m.a)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("a-page-header",{attrs:{"sub-title":"Products"}},[r("template",{slot:"extra"},[r("a-button",{attrs:{type:"primary"},on:{click:function(e){t.productForm=!0}}},[t._v("New Products")])],1)],2),t._v(" "),r("a-row",[r("a-col",{attrs:{span:3}},[r("table",{ref:"example",staticClass:"table table-hover table-bordered",style:{display:t.showTable}},[r("thead",[r("tr",[r("th",{attrs:{width:"25%"}},[t._v("Image")]),t._v(" "),r("th",{attrs:{width:"15%"}},[t._v("Code")]),t._v(" "),r("th",{attrs:{width:"35%"}},[t._v("Name")]),t._v(" "),r("th",{attrs:{width:"10%"}},[t._v("PV")]),t._v(" "),r("th",{attrs:{width:"15%"}},[t._v("Amount")])])]),t._v(" "),r("tbody",t._l(t.products,(function(e){return t.products.length?r("tr",{key:e.id,staticClass:"pr-tr"},[r("td",[r("img",{attrs:{width:"100",src:e.image_path}})]),t._v(" "),r("td",[t._v(t._s(e.code))]),t._v(" "),r("td",[t._v(t._s(e.name))]),t._v(" "),r("td",[t._v(t._s(e.pv))]),t._v(" "),r("td",[t._v(t._s(e.actual_amount))])]):t._e()})),0)])])],1),t._v(" "),r("br"),t._v(" "),r("a-modal",{attrs:{visible:t.productForm},on:{cancel:function(e){t.productForm=!1}}},[r("template",{slot:"footer"},[r("a-button",{key:"back",on:{click:t.reset}},[t._v("Cancel")]),t._v(" "),r("a-button",{key:"submit",attrs:{type:"primary",loading:t.loading},on:{click:t.createProduct}},[t._v("Submit")])],1),t._v(" "),r("a-input",{staticStyle:{"margin-top":"25px"},attrs:{placeholder:"Product name"},on:{change:t.setCode},model:{value:t.item.name,callback:function(e){t.$set(t.item,"name",e)},expression:"item.name"}}),t._v(" "),r("a-input",{staticStyle:{"margin-top":"25px"},attrs:{placeholder:"PV"},on:{change:t.setCode},model:{value:t.item.pv,callback:function(e){t.$set(t.item,"pv",e)},expression:"item.pv"}}),t._v(" "),r("a-input",{staticStyle:{"margin-top":"25px"},attrs:{type:"number",placeholder:"Amount"},model:{value:t.item.price,callback:function(e){t.$set(t.item,"price",e)},expression:"item.price"}}),t._v(" "),r("a-input",{staticStyle:{"margin-top":"25px"},attrs:{type:"number",placeholder:"Actual Amount"},model:{value:t.item.actual_amount,callback:function(e){t.$set(t.item,"actual_amount",e)},expression:"item.actual_amount"}}),t._v(" "),r("a-select",{staticStyle:{"margin-top":"25px",width:"100%",display:"block"},attrs:{placeholder:"Select Category"},model:{value:t.item.category_id,callback:function(e){t.$set(t.item,"category_id",e)},expression:"item.category_id"}},t._l(t.categories,(function(e){return r("a-select-option",{key:e.id},[t._v(t._s(e.name))])})),1),t._v(" "),r("a-upload",{attrs:{"list-type":"picture","default-file-list":t.fileList,remove:t.handleRemove,"before-upload":t.beforeUpload}},[r("a-button",{staticStyle:{"margin-top":"25px"}},[r("a-icon",{attrs:{type:"upload"}}),t._v("\n          Upload Product Image\n        ")],1)],1)],2),t._v(" "),r("a-space",[r("a-input",{attrs:{placeholder:"Search Product"},on:{change:t.search},model:{value:t.searchQuery,callback:function(e){t.searchQuery=e},expression:"searchQuery"}}),t._v(" "),r("a-button",{attrs:{type:"primary",loading:t.searching},on:{click:t.resetProducts}},[t._v("\n        "+t._s(t.searching?"Searching ... ":"Reset")+"\n      ")])],1),t._v(" "),r("br"),r("br"),t._v(" "),t.products.length?r("a-button",{attrs:{type:"primary"},on:{click:t.printProduct}},[t._v("Download")]):t._e(),t._v(" "),t.products?r("a-table",{attrs:{id:"products",columns:t.columns,"data-source":t.products,rowKey:function(t){return t.id},scroll:{x:1500},pagination:"{false}",size:"small"},scopedSlots:t._u([{key:"action",fn:function(text){return r("span",{},[r("a-popconfirm",{attrs:{title:"Sure you want to "+(text.status?"disable":"enable")+" product?","ok-text":"Yes","cancel-text":"No"},on:{confirm:function(e){return t.disableEnableProduct(text)},cancel:function(e){t.visible=!1}}},[r("a",{attrs:{href:"#"}},[t._v(t._s(text.status?"Disable Product":"Enable Product"))])]),t._v(" "),text.status?r("a-button",{attrs:{type:"link"},on:{click:function(e){return t.editProduct(text)}}},[t._v("Edit")]):t._e(),t._v(" "),r("a-icon",{attrs:{type:"delete"},on:{click:function(e){return t.deleteProduct(text.id)}}})],1)}},{key:"status",fn:function(e){return r("span",{},[r("a-tag",{attrs:{color:e?"green":"volcano"}},[t._v(t._s(e?"Enabled":"Disabled"))])],1)}},{key:"image",fn:function(image){return r("span",{},[r("img",{attrs:{width:"70",src:image,alt:""}})])}},{key:"price",fn:function(e){return r("span",{},[r("span",[t._v(t._s(t._f("currency")(e)))])])}},{key:"amount",fn:function(e){return r("span",{},[r("span",[t._v(t._s(t._f("currency")(e)))])])}}],null,!1,1900399517)}):t._e()],1)}),[],!1,null,"5cb07863",null);e.default=component.exports},903:function(t,e,r){"use strict";var n=r(28),o=r(138).findIndex,c=r(305),d=r(96),l=!0,m=d("findIndex");"findIndex"in[]&&Array(1).findIndex((function(){l=!1})),n({target:"Array",proto:!0,forced:l||!m},{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),c("findIndex")},906:function(t,e,r){"use strict";var n=r(28),o=r(306),c=r(165),d=r(62),l=r(97),m=r(307),f=r(184),h=r(185),v=r(96),_=h("splice"),x=v("splice",{ACCESSORS:!0,0:0,1:2}),y=Math.max,k=Math.min;n({target:"Array",proto:!0,forced:!_||!x},{splice:function(t,e){var r,n,h,v,_,x,w=l(this),P=d(w.length),S=o(t,P),$=arguments.length;if(0===$?r=n=0:1===$?(r=0,n=P-S):(r=$-2,n=k(y(c(e),0),P-S)),P+r-n>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(h=m(w,n),v=0;v<n;v++)(_=S+v)in w&&f(h,v,w[_]);if(h.length=n,r<n){for(v=S;v<P-n;v++)x=v+r,(_=v+n)in w?w[x]=w[_]:delete w[x];for(v=P;v>P-n+r;v--)delete w[v-1]}else if(r>n)for(v=P-n;v>S;v--)x=v+r-1,(_=v+n-1)in w?w[x]=w[_]:delete w[x];for(v=0;v<r;v++)w[v+S]=arguments[v+2];return w.length=P-n+r,h}})},909:function(t,e,r){"use strict";r(48),r(95);var n=r(27);e.a={methods:{saveFile:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,data;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t){r.next=3;break}return r.abrupt("return",console.log("No file"));case 3:return o=function(t){return new Promise((function(e){var r=new FileReader;r.onloadend=function(){return e(r.result)},r.readAsDataURL(t)}))},r.next=6,o(n);case 6:return data=r.sent,r.abrupt("return",e.$cloudinary.upload(data,{folder:"phreezone",upload_preset:"foodie_preset"}));case 8:case"end":return r.stop()}}),r)})))()}}}},917:function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var n=r(266);var o=r(312);function c(t){return function(t){if(Array.isArray(t))return Object(n.a)(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(o.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},930:function(t,e,r){var content=r(1009);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(46).default)("fc50c1c2",content,!0,{sourceMap:!1})}}]);