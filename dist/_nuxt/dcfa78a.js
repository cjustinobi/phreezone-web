(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{1062:function(e,t,r){e.exports=r.p+"img/close-pkg.0668999.jpg"},1063:function(e,t,r){e.exports=r.p+"img/open-pack.6cfc5c7.png"},1064:function(e,t,r){"use strict";r(949)},1065:function(e,t,r){(t=r(45)(!1)).push([e.i,".md[data-v-0cf87335]{margin-bottom:10px}",""]),e.exports=t},1105:function(e,t,r){"use strict";r.r(t);r(903),r(95);var n=r(27),d=r(901),o=r(8),c=r.n(o),l=[{title:"Full Name",dataIndex:"user",scopedSlots:{customRender:"user"},width:"10%"},{title:"Package",dataIndex:"package.name",width:"10%"},{title:"Pack Prize",dataIndex:"pack",width:"10%"},{title:"Stockist",dataIndex:"agent",scopedSlots:{customRender:"agent"},width:"10%"},{title:"Redeemed",dataIndex:"redeemed",scopedSlots:{customRender:"redeemed"},width:"10%"},{title:"Redeemed By",dataIndex:"redeemed_by",scopedSlots:{customRender:"redeemedBy"},width:"10%"},{title:"Upgrade Date",dataIndex:"created_at",scopedSlots:{customRender:"created"},width:"10%"},{title:"Redeemed Date",dataIndex:"updated_at",scopedSlots:{customRender:"updated"},width:"10%"},{title:"Redeem",scopedSlots:{customRender:"redeem"},width:"10%"}],f={name:"upgrade-pack",mixins:[d.a],layout:"dashboard",data:function(){return{dateFormat:"d MMM, Y",upgrades:"",visible:!1,columns:l,userReferral:"",upgradeUser:"",start:"",end:""}},methods:{moment:c.a,getUpgrades:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$post("user/upgradePacks/".concat(e.upgradeUser?e.upgradeUser.id:e.userId),{start:e.start,end:e.end,singleUser:!!e.upgradeUser});case 2:e.upgrades=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},redeem:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$axios.$post("user/redeemPack/".concat(e),{redeemedBy:t.userId});case 2:n=r.sent,n.success&&(d=t.upgrades.findIndex((function(t){return t.id==e})),t.upgrades[d].redeemed="1"==t.upgrades[d].redeemed?0:1,t.$message.success("Pack Redeemed"));case 5:case"end":return r.stop()}}),r)})))()},getMember:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.$post("user/null",{userReferral:e.userReferral});case 3:e.upgradeUser=t.sent.data,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),e.$message.error("Invalid Referral code entered");case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},disabledDate:function(e){return this.start&&this.start<c()().endOf("day")},startDate:function(e,t){this.start=t},endDate:function(e,t){this.end=t}},computed:{filteredCol:function(){if(this.isStockist)return this.columns;for(var e=[],i=0;i<this.columns.length;i++)2!==i&&5!==i&&7!==i&&e.push(this.columns[i]);return e},disableEndDate:function(){return!this.start}},mounted:function(){this.getUpgrades()},watch:{upgradeUser:function(e){this.getUpgrades()},end:function(e){e&&this.start,this.getUpgrades()},start:function(e){e&&this.end,this.getUpgrades()}}},m=(r(1064),r(34)),component=Object(m.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-page-header",{attrs:{"sub-title":"EP Upgrade Series"}}),e._v(" "),e.isStockist&&e.upgradeUser?n("h6",[e._v(e._s(e.upgradeUser.full_name))]):e._e(),e._v(" "),n("a-row",{attrs:{gutter:12}},[n("a-col",{attrs:{lg:4}},[e.isStockist?n("a-input-search",{staticStyle:{width:"150px","margin-bottom":"10px"},attrs:{placeholder:"Member code"},on:{blur:e.getMember},model:{value:e.userReferral,callback:function(t){e.userReferral=t},expression:"userReferral"}}):e._e()],1),e._v(" "),e.isAdmin?n("a-col",{attrs:{lg:6}},[n("a-form-model",[n("a-date-picker",{staticClass:"form-control md",attrs:{placeholder:"Start"},on:{change:e.startDate}})],1)],1):e._e(),e._v(" "),e.isAdmin?n("a-col",{attrs:{lg:6}},[n("a-form-model",[n("a-date-picker",{staticClass:"form-control md",attrs:{disabled:e.disableEndDate,placeholder:"End"},on:{change:e.endDate}})],1)],1):e._e()],1),e._v(" "),n("br"),n("br"),e._v(" "),e.upgrades?n("a-table",{attrs:{columns:e.filteredCol,"data-source":e.upgrades,rowKey:function(e){return e.id},scroll:{x:1500,y:300},size:"small",pagination:{pageSize:50}},scopedSlots:e._u([{key:"redeemed",fn:function(e){return n("span",{},[n("img",{attrs:{src:r(0==e?1062:1063),alt:"pack",width:"50px"}})])}},{key:"user",fn:function(t){return n("span",{},[n("span",[e._v(e._s(t.full_name)+" "),n("br"),e._v(" "),n("b",[e._v(e._s(t.referral))])])])}},{key:"agent",fn:function(t){return n("span",{},[n("span",[e._v(e._s(t.full_name)+" "),n("br"),e._v(" "),n("b",[e._v(e._s(t.referral))])])])}},{key:"redeemedBy",fn:function(t){return n("span",{},[t?n("span",[e._v(e._s(t.full_name)+" "),n("br"),e._v(" "),n("b",[e._v(e._s(t.referral))])]):e._e()])}},{key:"pkg",fn:function(t){return n("span",{},[e._v(e._s(null==t?"N/P":t))])}},{key:"created",fn:function(t){return n("span",{},[e._v(e._s(e.formatDate(t)))])}},{key:"updated",fn:function(t,r){return"1"==r.redeemed?n("span",{},[e._v(e._s(e.formatDate(t)))]):e._e()}},{key:"redeem",fn:function(text){return"1"==e.$auth.user.isAgent&&"0"==text.redeemed?n("span",{},[n("a-popconfirm",{attrs:{title:"Sure you want to redeem?","ok-text":"Yes","cancel-text":"No"},on:{confirm:function(t){return e.redeem(text.id)},cancel:function(t){e.visible=!1}}},[n("a",{attrs:{href:"#"}},[e._v("Redeem")])])],1):e._e()}}],null,!0)}):e._e()],1)}),[],!1,null,"0cf87335",null);t.default=component.exports},901:function(e,t,r){"use strict";var n=r(904),d=r.n(n);t.a={methods:{formatDate:function(e){var t="";return e&&(t=d()(new Date(e),this.dateFormat)),t},getTime:function(e){var t="";return e&&(t=d()(new Date(e),this.dateFormat2)),t}}}},903:function(e,t,r){"use strict";var n=r(28),d=r(138).findIndex,o=r(305),c=r(96),l=!0,f=c("findIndex");"findIndex"in[]&&Array(1).findIndex((function(){l=!1})),n({target:"Array",proto:!0,forced:l||!f},{findIndex:function(e){return d(this,e,arguments.length>1?arguments[1]:void 0)}}),o("findIndex")},949:function(e,t,r){var content=r(1065);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(46).default)("dc20aea4",content,!0,{sourceMap:!1})}}]);