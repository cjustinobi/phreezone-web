(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{1100:function(e,t,r){"use strict";r.r(t);r(585),r(95);var n=r(27),o=r(901),l=[{title:"Bought By",dataIndex:"user.full_name",scopedSlots:{customRender:"buyer"}},{title:"Sold By",dataIndex:"sold_by.full_name",scopedSlots:{customRender:"seller"}},{title:"Amount",dataIndex:"amount",scopedSlots:{customRender:"amount"}},{title:"Status",dataIndex:"paid",scopedSlots:{customRender:"paid"}},{title:"Date",dataIndex:"created_at",scopedSlots:{customRender:"date"}},{title:"View Items",dataIndex:"id",scopedSlots:{customRender:"id"}}],c=[{title:"Item",dataIndex:"name"},{title:"PV",dataIndex:"pv"},{title:"Quantity",dataIndex:"qty"},{title:"Date",dataIndex:"created_at",scopedSlots:{customRender:"date"}},{title:"Amount",key:"amount",dataIndex:"amount",scopedSlots:{customRender:"amount"}}],d={name:"stream-sales-list",layout:"dashboard",mixins:[o.a],data:function(){return{sales:"",columns:l,columns2:c,week:"",soldItems:"",loading:!1,showSoldItems:!1,customer:"",userReferral:"",totalSales:"",dateFormat:"p d MMM, Y"}},methods:{getSales:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$post("user/getOrders",{weekNumber:e.week,userId:e.customer.id});case 2:e.sales=t.sent.data;case 3:case"end":return t.stop()}}),t)})))()},getItems:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$axios.$post("user/soldStreamItems/".concat(e));case 2:(n=r.sent).success&&(t.soldItems=n.data,t.showSoldItems=!0);case 4:case"end":return r.stop()}}),r)})))()},implementStream:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,e.$axios.$post("user/implementStream",{weekNumber:e.week});case 4:t.sent.success&&(e.loading=!1,e.$message.success("Stream Implemented"),e.getSales()),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),e.loading=!1,e.$message.error(t.t0.response.data.message);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},setWeek:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("date");case 2:e.week=t.sent;case 3:case"end":return t.stop()}}),t)})))()},getMember:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.$post("user/null",{userReferral:e.userReferral});case 3:(r=t.sent).data&&(e.customer=r.data,e.getSales()),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.$message.error("Invalid Referral code entered");case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}},mounted:function(){this.setWeek(),this.getSales()},computed:{filteredCol:function(){if(this.isStockist)return this.columns;for(var e=[],i=0;i<this.columns.length;i++)3!==i&&e.push(this.columns[i]);return e}},watch:{sales:{handler:function(e){e.length?this.totalSales=e.reduce((function(e,t){return+e+ +t.amount}),0):this.totalSales=0},immediate:!0}}},m=r(34),component=Object(m.a)(d,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-page-header",{attrs:{"sub-title":"Stream Orders"}}),e._v(" "),r("div",{staticStyle:{background:"#ECECEC",padding:"30px","margin-bottom":"28px"}},[r("a-row",{attrs:{gutter:4}},[r("a-col",{attrs:{md:8,xs:24}},[r("a-card",[r("a-statistic",{staticStyle:{"margin-right":"50px"},attrs:{title:"Total Stream Orders for week "+e.week,value:e._f("currency")(e.totalSales),precision:2,"value-style":{color:"#3f8600"}}})],1)],1)],1)],1),e._v(" "),r("a-row",[r("a-col",{attrs:{span:"6"}},[r("a-input",{staticStyle:{width:"188px","margin-bottom":"8px"},attrs:{placeholder:"Enter week number",min:"1",type:"number"},on:{change:e.getSales},model:{value:e.week,callback:function(t){e.week=t},expression:"week"}})],1),e._v(" "),e.isAdmin?r("a-col",{attrs:{span:"6"}}):e._e()],1),e._v(" "),r("a-modal",{attrs:{title:"Sold Items for week "+e.week,footer:null},model:{value:e.showSoldItems,callback:function(t){e.showSoldItems=t},expression:"showSoldItems"}},[e.soldItems?r("a-table",{attrs:{columns:e.columns2,"data-source":e.soldItems,rowKey:function(e){return e.id},size:"small"},scopedSlots:e._u([{key:"date",fn:function(t){return r("span",{},[e._v(e._s(e.formatDate(t)))])}},{key:"ids",fn:function(t,n){return r("span",{},[r("a",{attrs:{href:"#"},on:{click:function(r){return r.preventDefault(),e.getItems(t)}}},[e._v("View")])])}}],null,!1,1263385991)}):e._e()],1),e._v(" "),e.sales?r("a-table",{attrs:{columns:e.filteredCol,"data-source":e.sales,rowKey:function(e){return e.id},size:"small"},scopedSlots:e._u([{key:"buyer",fn:function(t,n){return r("span",{},[e._v("\n        "+e._s(t)+" "),r("br"),r("a-tag",{attrs:{color:"green"}},[e._v(e._s(n.user.referral))])],1)}},{key:"seller",fn:function(t,n){return r("span",{},[e._v("\n        "+e._s(t)+" "),r("br"),r("a-tag",{attrs:{color:"green"}},[e._v(e._s(n.sold_by.referral))])],1)}},{key:"paid",fn:function(t){return r("span",{},[r("a-tag",{attrs:{color:"1"==t?"green":"volcano"}},[e._v("\n          "+e._s("1"==t?"Implemented":"Not Implemented")+"\n        ")])],1)}},{key:"date",fn:function(t){return r("span",{},[e._v(e._s(e.formatDate(t)))])}},{key:"id",fn:function(t){return r("span",{},[r("a",{attrs:{href:"#"},on:{click:function(r){return r.preventDefault(),e.getItems(t)}}},[e._v("View")])])}}],null,!1,2733047914)}):e._e()],1)}),[],!1,null,null,null);t.default=component.exports},901:function(e,t,r){"use strict";var n=r(904),o=r.n(n);t.a={methods:{formatDate:function(e){var t="";return e&&(t=o()(new Date(e),this.dateFormat)),t},getTime:function(e){var t="";return e&&(t=o()(new Date(e),this.dateFormat2)),t}}}}}]);