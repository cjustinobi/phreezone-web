(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1051:function(e,t,r){"use strict";r(943)},1052:function(e,t,r){(t=r(45)(!1)).push([e.i,".ref[data-v-5e2a0642]{width:200px;margin-bottom:25px}.text-muted[data-v-5e2a0642]{margin:12px 0}.dynamic-delete-button[data-v-5e2a0642]{cursor:pointer;position:relative;top:4px;font-size:24px;color:#999;transition:all .3s}.dynamic-delete-button[data-v-5e2a0642]:hover{color:#777}.dynamic-delete-button[disabled][data-v-5e2a0642]{cursor:not-allowed;opacity:.5}",""]),e.exports=t},1095:function(e,t,r){"use strict";r.r(t);r(586),r(585),r(906),r(95);var n=r(27),o={name:"shopping-credit",layout:"dashboard",data:function(){return{loading:!1,canSubmit:!0,userBonus:"",userReferral:"",enteredAmount:0,availableBalance:0,formItemLayout:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},formItemLayoutWithOutLabel:{wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}}},dynamicValidateForm:{data:[],stockistId:this.$auth.user.id}}},methods:{getShoppingBonus:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.$post("user/shoppingBonus",{referral:e.userReferral});case 3:e.userBonus=t.sent.data,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),e.$message.error("Invalid referral entered");case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(t.userReferral&&t.canSubmit&&e){t.loading=!0;try{t.$axios.$post("user/spendShoppingBonus",t.dynamicValidateForm).then((function(e){t.getShoppingBonus(),t.dynamicValidateForm.data=[],t.loading=!1,t.$message.success("Added successfully")}))}catch(e){console.log(e.response.data.message)}}}))},resetForm:function(e){this.$refs[e].resetFields()},removeItem:function(e){var t=this.dynamicValidateForm.data.indexOf(e);-1!==t&&this.dynamicValidateForm.data.splice(t,1)},addItem:function(){this.canSubmit&&this.dynamicValidateForm.data.push({item:"",amount:"",user_id:this.userBonus.user.id})}},watch:{"dynamicValidateForm.data":{handler:function(data){this.enteredAmount=data.reduce((function(e,t){return+e+ +t.amount}),0),this.enteredAmount&&(this.enteredAmount>this.availableBalance?(this.$message.error("Item amount has exceeded available balance"),this.canSubmit=!1):this.canSubmit=!0)},deep:!0},userBonus:{handler:function(data){this.availableBalance=data.creditEarned-data.totalShoppingBonusPaid}}}},l=(r(1051),r(34)),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-page-header",{attrs:{"sub-title":"Shopping Credit"}}),e._v(" "),r("a-input-search",{staticClass:"ref",attrs:{"enter-button":"Send",placeholder:"Member Referral"},on:{search:e.getShoppingBonus},model:{value:e.userReferral,callback:function(t){e.userReferral=t},expression:"userReferral"}}),e._v(" "),r("div",{staticStyle:{background:"#ECECEC",padding:"30px"}},[r("a-row",{attrs:{gutter:4}},[r("a-col",{attrs:{md:8,xs:24}},[r("a-card",[r("a-statistic",{staticStyle:{"margin-right":"50px"},attrs:{title:"Credit Used",value:e._f("currency")(e.userBonus.totalShoppingBonusPaid),precision:2,"value-style":{color:"#3f8600"}}})],1)],1),e._v(" "),r("a-col",{attrs:{md:8,xs:24}},[r("a-card",[r("a-statistic",{staticClass:"demo-class",attrs:{title:"Credit Balance",value:e._f("currency")(e.availableBalance),"value-style":{color:"#1890ff"}}})],1)],1)],1)],1),e._v(" "),e.userBonus?r("h4",{staticClass:"text-muted"},[e._v("Items for "+e._s(e.userBonus.user.full_name))]):e._e(),e._v(" "),e.userBonus?r("a-form-model",e._b({ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},"a-form-model",e.formItemLayoutWithOutLabel,!1),[e._l(e.dynamicValidateForm.data,(function(t,n){return r("a-form-model-item",e._b({key:n,attrs:{label:0===n?"Items to Purchase":"",prop:"data."+n+".item",rules:{required:!0,message:"Field is empty",trigger:"blur"}}},"a-form-model-item",0===n?e.formItemLayout:{},!1),[r("a-row",{attrs:{gutter:"2"}},[r("a-col",{attrs:{xs:10,md:8}},[r("a-input",{staticStyle:{"margin-right":"8px"},attrs:{placeholder:"Enter Product name"},model:{value:t.item,callback:function(r){e.$set(t,"item",r)},expression:"item.item"}})],1),e._v(" "),r("a-col",{attrs:{xs:10,md:4}},[r("a-input",{staticStyle:{"margin-right":"8px"},attrs:{type:"number",placeholder:"Enter Amount"},model:{value:t.amount,callback:function(r){e.$set(t,"amount",r)},expression:"item.amount"}})],1),e._v(" "),r("a-col",{attrs:{xs:4,md:2}},[e.dynamicValidateForm.data.length>1?r("a-icon",{staticClass:"dynamic-delete-button",attrs:{type:"minus-circle-o",disabled:1===e.dynamicValidateForm.data.length},on:{click:function(r){return e.removeItem(t)}}}):e._e()],1)],1)],1)})),e._v(" "),r("a-form-model-item",e._b({},"a-form-model-item",e.formItemLayoutWithOutLabel,!1),[r("a-button",{attrs:{type:"dashed"},on:{click:e.addItem}},[r("a-icon",{attrs:{type:"plus"}}),e._v(" Add field")],1)],1),e._v(" "),e.dynamicValidateForm.data.length?r("a-form-model-item",e._b({},"a-form-model-item",e.formItemLayoutWithOutLabel,!1),[r("a-button",{attrs:{type:"primary","html-type":"submit"},on:{click:function(t){return e.submitForm("dynamicValidateForm")}}},[e._v("\n          "+e._s(e.loading?"Submitting":"Submit ")+"\n        ")]),e._v(" "),r("a-button",{staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.resetForm("dynamicValidateForm")}}},[e._v("Reset")])],1):e._e()],2):e._e()],1)}),[],!1,null,"5e2a0642",null);t.default=component.exports},906:function(e,t,r){"use strict";var n=r(28),o=r(306),l=r(165),d=r(62),m=r(97),c=r(307),f=r(184),h=r(185),v=r(96),y=h("splice"),x=v("splice",{ACCESSORS:!0,0:0,1:2}),_=Math.max,S=Math.min;n({target:"Array",proto:!0,forced:!y||!x},{splice:function(e,t){var r,n,h,v,y,x,F=m(this),B=d(F.length),w=o(e,B),C=arguments.length;if(0===C?r=n=0:1===C?(r=0,n=B-w):(r=C-2,n=S(_(l(t),0),B-w)),B+r-n>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(h=c(F,n),v=0;v<n;v++)(y=w+v)in F&&f(h,v,F[y]);if(h.length=n,r<n){for(v=w;v<B-n;v++)x=v+r,(y=v+n)in F?F[x]=F[y]:delete F[x];for(v=B;v>B-n+r;v--)delete F[v-1]}else if(r>n)for(v=B-n;v>w;v--)x=v+r-1,(y=v+n-1)in F?F[x]=F[y]:delete F[x];for(v=0;v<r;v++)F[v+w]=arguments[v+2];return F.length=B-n+r,h}})},943:function(e,t,r){var content=r(1052);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(46).default)("5d909e4e",content,!0,{sourceMap:!1})}}]);